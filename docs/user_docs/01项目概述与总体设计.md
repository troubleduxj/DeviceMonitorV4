## 一、项目背景

随着工业4.0和智能制造的推进，企业对设备运行状态的实时监控、故障的早期预警以及预测性维护的需求日益增长。传统的监控方式往往存在数据孤岛、响应滞后、分析能力不足等问题。本项目旨在构建一个现代化的工业物联网平台，通过实时数据采集、智能分析与可视化，提升设备管理效率和生产可靠性。

## 二、项目目标

本项目的项目目标主要是搭建一套设备实时监测系统平台，实现如下核心目标：

1. **实时监控**：实现对接入设备的运行参数进行7x24小时不间断监控。
   
2. **异常检测**：利用机器学习模型自动识别设备运行异常，并及时告警。
   
3. **预测性维护**：基于历史数据和模型预测，为设备维护提供决策支持，减少非计划停机。
   
4. **智能交互**：结合大语言模型，提供自然的语言查询、报告生成等智能化服务。
   
5. **高效管理**：提供统一的平台管理设备、用户、模型及系统配置。

## 三、系统总体架构

提供整体架构图，包括：
- 数据采集层
- 服务处理层
- 数据存储层
- 应用展示层

## 四、技术选型

| 技术方向 | 技术方案                            |
| ---- | ------------------------------- |
| 前端框架 | Vue 3 + TypeScript + Ant Design Vue |
| 后端框架 | FastAPI                         |
| 数据库  | TDengine（实时数据），PostgreSQL（业务数据） |
| 可视化  | echarts、大屏组件库                   |
| AI模型 | Python + scikit-learn           |

### 前端（Vue.js）

- __框架__: 基于 Vue.js，用于构建用户界面。

- __UI 组件库__: 使用了 Naive UI 等组件库（从 `NCard` 等组件的使用推断）。

- __模块划分__: `web/src/api` 封装前端API请求，`web/src/views` 组织页面，`web/src/components` 存放可复用组件。



### 后端（Python/FastAPI）

- __框架__: 基于 FastAPI，提供高性能的API服务。

- __ORM__: 使用 Tortoise ORM 进行数据库操作，这意味着您可能使用 PostgreSQL 等关系型数据库。

- __时序数据库__: 集成了 TDengine 用于存储和查询时序数据（如设备实时数据）。

- __模块划分__: 结构清晰，`app/api` 定义路由，`app/controllers` 封装业务逻辑，`app/models` 定义数据库模型，`app/schemas` 定义数据校验和序列化模型（Pydantic），`app/core` 包含核心工具类（如 `tdengine_connector`）。

- __认证__: 存在 `DependAuth` 依赖，表明有用户认证机制。





## 五、关键模块说明

简要介绍每个核心模块及其作用。
### 1. 系统看板

系统看板是平台的核心概览页面，旨在提供设备运行状态、告警信息、数据趋势等关键指标的实时可视化展示。它通过集成各类图表和统计数据，帮助用户快速了解系统整体运行状况，及时发现潜在问题。

-   **核心功能**：
    -   **实时数据概览**：展示在线设备数量、离线设备数量、当前告警数量、数据采集速率等核心指标。
    -   **设备状态分布**：通过饼图或柱状图展示设备在线、离线、故障等状态的比例。
    -   **关键参数趋势图**：实时或准实时展示选定设备的温度、压力、电流等关键运行参数的历史趋势。
    -   **告警事件速览**：显示最新发生的告警事件，包括告警等级、时间、设备和简要描述。
    -   **快捷入口**：提供到设备管理、告警中心、数据统计等页面的快捷跳转，方便用户深入查看详情。
-   **作用**：
    -   **宏观监控**：提供系统整体运行的“一站式”视图。
    -   **决策支持**：帮助管理人员快速掌握设备健康状况和生产效率。
    -   **异常预警**：通过直观的数据变化，辅助用户及时发现异常并采取行动。

### 2. 系统设置

系统设置模块是平台的管理中心，提供对系统各项基础数据、权限、日志和参数的配置与维护功能。它确保了系统的灵活性、可管理性和安全性。

-   **核心功能**：
    -   **用户管理**：实现对系统用户账号的生命周期管理，包括用户的创建、编辑、禁用、启用和删除，以及密码重置等功能。
    -   **角色管理**：定义不同权限集合的角色，并为角色分配菜单、API等操作权限，支持角色的创建、编辑和删除。
    -   **菜单管理**：配置系统前端导航菜单的层级结构、显示名称、图标和对应的路由路径，支持菜单的增删改查和排序。
    -   **API管理**：注册和管理后端API接口信息，包括接口路径、请求方法、描述等，并与权限系统关联，实现接口级别的访问控制。
    -   **部门管理**：构建组织架构的部门树，用于用户归属和数据权限的划分，支持部门的增删改查。
    -   **审计日志**：详细记录用户在系统中的关键操作行为（如登录、数据修改、配置变更等），包括操作时间、操作人、操作类型、操作对象和操作结果，便于安全审计和问题追溯。
    -   **系统参数配置**：提供对系统全局参数的动态配置界面，如系统名称、默认设置、第三方服务接口地址等，无需修改代码即可调整系统行为。
-   **作用**：
    -   **权限控制**：通过用户、角色、菜单和API的精细化管理，实现多维度、可配置的权限控制体系。
    -   **系统维护**：提供统一的入口对系统基础数据和配置进行维护，降低运维成本。
    -   **安全审计**：审计日志功能为系统安全提供重要支撑，便于追踪异常行为和满足合规性要求。
    -   **灵活性**：通过参数配置，使系统能够适应不同的业务需求和部署环境。


### 3. 设备信息

设备信息模块是平台管理和监控物理设备的核心功能区域，涵盖了设备的生命周期管理、实时运行状态监测以及历史数据的查询与分析。旨在为用户提供全面、准确的设备视图。

-   **核心功能**：
    -   **设备管理**：
        -   **设备注册与配置**：支持新设备的注册，包括设备ID、名称、类型、位置、所属部门、通信协议等基本信息的录入和管理。
        -   **设备状态管理**：实时显示设备的在线/离线状态、运行状态（正常、故障、维护中等）。
        -   **设备分组与标签**：支持对设备进行自定义分组和标签管理，便于分类查找和批量操作。
        -   **固件与软件版本管理**：记录设备的固件和应用软件版本信息，为远程升级和维护提供依据。
    -   **设备实时监测**：
        -   **实时数据采集与展示**：通过与设备建立连接，实时采集设备的传感器数据、运行参数、状态信息等，并以图表、仪表盘等形式直观展示。
        -   **数据刷新频率配置**：支持配置实时数据的刷新频率，满足不同场景的监控需求。
        -   **多参数同时监测**：允许用户选择多个关键参数进行同屏对比监测，便于分析参数间的关联性。
    -   **历史数据查询**：
        -   **多维度查询**：提供基于时间范围、设备ID、参数类型等多种条件组合的历史数据查询功能。
        -   **数据可视化分析**：将查询到的历史数据以趋势图、散点图等形式展示，支持缩放、平移、数据点详情查看等交互。
        -   **数据导出**：支持将查询结果导出为CSV、Excel等格式文件，便于离线分析和报告生成。
-   **作用**：
    -   **资产管理**：实现对企业物理设备资产的数字化管理，提高设备台账的准确性和可追溯性。
    -   **运行监控**：实时掌握设备运行状况，及时发现异常，减少停机时间。
    -   **故障诊断**：通过历史数据分析，辅助工程师进行故障诊断和原因分析。
    -   **数据积累**：为后续的数据分析、机器学习模型训练提供高质量的历史数据基础。


### 4. 数据统计

数据统计模块旨在对设备运行数据进行深度挖掘和分析，提供多维度、可视化的统计报告，帮助用户从宏观层面了解设备群体的运行效率、健康状况和趋势，为运营决策提供数据支持。

-   **核心功能**：
    -   **设备在线率统计**：统计设备在特定时间段内的在线时长、在线率，支持按设备类型、区域、时间粒度（日、周、月）进行聚合分析，并通过图表（如折线图、柱状图）展示趋势。
    -   **设备稼动率分析**：统计设备的运行时间、停机时间、故障时间等，计算设备稼动率，评估设备利用效率。
    -   **能耗统计**：针对具备能耗监测能力的设备，统计其历史能耗数据，分析能耗趋势和异常，辅助节能优化。
    -   **特定行业指标统计**：例如，针对焊接设备，统计焊接时长、焊接点数、焊接合格率等关键生产指标，提供行业定制化的数据分析。
    -   **自定义报表**：允许用户根据需求选择统计维度和指标，生成自定义的统计报表。
-   **作用**：
    -   **运营优化**：通过数据分析发现设备运行瓶颈，优化生产流程，提高整体运营效率。
    -   **成本控制**：识别高能耗设备或异常能耗模式，辅助企业降低运营成本。
    -   **绩效评估**：为设备管理人员和生产团队提供量化的绩效评估依据。
    -   **趋势预测**：基于历史统计数据，对未来设备运行趋势进行预测，为设备采购、维护计划提供参考。


### 5. 告警中心

告警中心是平台集中处理和管理设备异常事件的模块，旨在提供实时的告警通知、详细的告警信息查询、告警处理流程以及告警统计分析功能，确保设备异常能够被及时发现、响应和解决。

-   **核心功能**：
    -   **实时告警**：接收并展示来自设备的实时告警信息，包括告警时间、设备ID、告警类型、告警等级（如紧急、重要、一般）、告警描述等。
    -   **告警查询与筛选**：提供多维度查询功能，用户可根据时间范围、设备、告警类型、告警等级、处理状态等条件筛选和查询历史告警记录。
    -   **告警处理**：支持对告警进行确认、指派、处理、关闭等操作，记录处理过程和处理结果，形成告警闭环管理。
    -   **告警通知**：可配置的告警通知机制，通过邮件、短信、微信等方式及时通知相关负责人。
    -   **告警统计分析**：对告警数据进行统计分析，生成告警趋势图、告警类型分布图、设备告警排行榜等，帮助用户分析告警规律和设备健康状况。
    -   **告警详情**：点击告警记录可查看详细信息，包括告警发生时的设备参数快照、相关日志、处理历史等。
-   **作用**：
    -   **风险预警**：及时发现设备运行中的异常和潜在风险，避免故障扩大或事故发生。
    -   **快速响应**：通过集中的告警管理和通知机制，缩短告警响应时间，提高问题解决效率。
    -   **运维优化**：通过告警数据分析，识别高频告警设备或告警类型，优化设备维护策略和提升设备可靠性。
    -   **责任追溯**：完整的告警处理记录，便于责任追溯和绩效评估。


### 6. AI 分析

AI 分析模块旨在利用人工智能技术对设备数据进行深度学习和模式识别，实现设备的智能故障诊断、预测性维护、运行优化等高级功能，从而提升设备的智能化管理水平和生产效率。

-   **核心功能**：
    -   **智能故障诊断**：基于历史故障数据和运行数据，训练AI模型（如机器学习、深度学习模型），自动识别设备运行中的异常模式，诊断潜在故障类型和原因，并提供诊断报告。
    -   **预测性维护**：通过分析设备运行参数（如振动、温度、电流等）的变化趋势，结合AI预测模型，提前预警设备部件的磨损或故障风险，实现从被动维修到主动预测性维护的转变。
    -   **运行优化建议**：根据AI模型对设备运行数据的分析，提供优化设备运行参数、调整生产策略的建议，以提高设备效率、降低能耗或提升产品质量。
    -   **异常行为检测**：实时监测设备数据流，利用AI算法检测偏离正常基线的异常行为，及时发出预警。
    -   **模型管理与迭代**：支持AI模型的上传、部署、版本管理和持续优化，确保分析的准确性和时效性。
    -   **可视化分析报告**：将AI分析结果以直观的图表和报告形式展示，便于用户理解和决策。
-   **作用**：
    -   **降低停机时间**：通过预测性维护，减少非计划性停机，提高设备可用性。
    -   **提升维护效率**：精准定位故障，减少人工排查时间，优化维修资源配置。
    -   **延长设备寿命**：及时发现并处理早期异常，避免设备部件的过度磨损，延长设备使用寿命。
    -   **优化生产性能**：通过运行优化建议，提升设备运行效率和生产质量。
    -   **数据价值挖掘**：充分利用设备大数据，将其转化为有价值的洞察和决策支持。

### 7. 流程编排

流程编排模块旨在提供一个可视化、低代码的工具，使用户能够灵活地设计、部署和管理设备相关的自动化业务流程。通过将不同的功能模块（如数据采集、数据处理、告警触发、指令下发、AI分析等）以图形化的方式进行组合，实现复杂的设备联动和业务自动化。

-   **核心功能**：
    -   **可视化流程设计器**：提供直观的拖拽式界面，用户可以通过连接不同的节点（如数据源、条件判断、动作执行、AI模型调用等）来构建业务流程。
    -   **节点库管理**：内置丰富的预定义节点，涵盖设备控制、数据处理、告警通知、第三方系统集成等功能，并支持自定义节点的扩展。
    -   **流程发布与版本管理**：支持将设计好的流程发布上线，并对流程进行版本管理，方便回溯和迭代。
    -   **流程执行与监控**：实时监控流程的运行状态、执行日志和异常情况，提供流程实例的追踪和管理。
    -   **条件与循环控制**：支持在流程中设置复杂的条件分支、循环和并行执行，以适应多变的业务场景。
    -   **数据转换与处理**：提供数据清洗、格式转换、计算等功能节点，确保数据在流程中的顺畅流转和有效利用。
-   **作用**：
    -   **业务自动化**：将重复性、规则性的设备相关业务流程自动化，减少人工干预，提高效率。
    -   **快速响应**：实现设备异常的自动判断和处理，缩短响应时间，降低潜在损失。
    -   **灵活配置**：无需编写代码即可快速调整和优化业务流程，适应不断变化的业务需求。
    -   **降低开发成本**：通过可视化编排，降低业务流程开发的门槛和成本。
    -   **提升系统集成度**：方便地集成不同系统和设备的功能，构建统一的智能管理平台。

