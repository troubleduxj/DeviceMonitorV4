# Mock功能安装图文教程（小白版）

## 🎯 安装前准备

**您需要的东西**：
- ✅ Windows电脑
- ✅ 已安装PostgreSQL数据库
- ✅ 项目文件夹在：`D:\Cursor\Project\DeviceMonitorV2_20251013_V1\DeviceMonitorV2`

**大约需要时间**：3-5分钟

---

## 📋 安装步骤总览

```
第1步：安装数据库表 (双击 install_mock_feature.bat)
   ↓
第2步：启动后端服务 (双击 start_backend.bat)
   ↓
第3步：登录系统
   ↓
第4步：初始化权限 (双击 init_mock_permissions.html)
   ↓
第5步：刷新页面，开始使用！
```

---

## 📖 详细步骤

### 🔹 第1步：安装数据库表

#### 1.1 找到安装脚本

打开文件夹：
```
D:\Cursor\Project\DeviceMonitorV2_20251013_V1\DeviceMonitorV2\scripts
```

找到这个文件：
```
install_mock_feature.bat  ← 就是这个！
```

#### 1.2 双击运行

- **双击** `install_mock_feature.bat`
- 会弹出一个黑色命令行窗口

#### 1.3 输入密码

看到提示：
```
密码：
```

**输入您的PostgreSQL密码**（通常是 `123456` 或 `postgres`），然后按回车

**注意**：输入密码时，屏幕上看不到任何字符，这是正常的！直接输入后按回车就行。

#### 1.4 等待完成

看到这些信息表示成功：
```
✅ Mock数据表创建成功！
✅ Mock管理菜单添加成功！
🎉 数据库安装完成！
```

按任意键关闭窗口。

---

### 🔹 第2步：启动后端服务

#### 2.1 找到启动脚本

在同一个 `scripts` 文件夹中，找到：
```
start_backend.bat  ← 就是这个！
```

#### 2.2 双击运行

- **双击** `start_backend.bat`
- 会弹出一个黑色命令行窗口
- 窗口会显示很多日志信息

#### 2.3 等待启动完成

当看到这些信息时，表示启动成功：
```
INFO:     Uvicorn running on http://0.0.0.0:8001
INFO:     Application startup complete.
```

**⚠️ 重要提醒**：
- ✅ **不要关闭这个窗口**！
- ✅ 让它一直开着
- ✅ 这就是后端服务器在运行

---

### 🔹 第3步：登录系统

#### 3.1 打开浏览器

- 打开 Chrome、Edge 或其他浏览器
- 地址栏输入：`http://localhost:3000`
- 按回车

#### 3.2 登录

使用您的管理员账号登录：
- 输入用户名
- 输入密码
- 点击"登录"按钮

登录成功后，您会看到系统主页。

---

### 🔹 第4步：初始化权限

#### 4.1 找到权限初始化页面

回到 `scripts` 文件夹，找到：
```
init_mock_permissions.html  ← 就是这个！
```

#### 4.2 双击打开

- **双击** `init_mock_permissions.html`
- 会在浏览器中打开一个漂亮的紫色页面

#### 4.3 执行初始化

在页面上：

1. 检查"前置条件检查"区域，确认：
   - ✅ 数据库表已创建
   - ✅ 后端服务已启动
   - ✅ 已登录系统 ← **这个必须是绿色的"✅ 已登录"**

2. 如果显示"❌ 未登录"：
   - 回到第3步重新登录
   - 登录后再打开这个页面

3. 点击蓝色大按钮：
   ```
   🚀 开始初始化权限
   ```

4. 等待执行，会看到黑色日志窗口显示进度

5. 看到以下信息表示成功：
   ```
   ✅ 初始化成功！
   📈 新创建: X 个按钮权限
   ```

6. 会弹出对话框询问是否刷新，点击"确定"

---

### 🔹 第5步：开始使用

#### 5.1 刷新系统页面

- 如果没有自动刷新，按键盘上的 **F5** 键
- 或点击浏览器的刷新按钮 🔄

#### 5.2 找到Mock管理菜单

刷新后，在**左侧菜单栏**找到：

```
📁 Mock数据管理  ← 就是这个！
```

可能在以下位置：
- "高级设置"分类下
- 或在菜单列表的底部

#### 5.3 开始使用

点击"Mock数据管理"，进入管理页面！

---

## ✅ 安装完成检查清单

请确认以下所有项目都是 ✅：

- [ ] 数据库表创建成功（第1步）
- [ ] 后端服务正在运行（第2步的窗口还开着）
- [ ] 已经登录系统（第3步）
- [ ] 权限初始化成功（第4步）
- [ ] 能看到"Mock数据管理"菜单（第5步）

---

## ❓ 遇到问题？

### 问题1：第1步提示"psql不是内部或外部命令"

**原因**：没有安装PostgreSQL，或没有添加到系统PATH

**解决方法**：

1. 确认是否安装了PostgreSQL
2. 找到PostgreSQL的安装目录，例如：
   ```
   C:\Program Files\PostgreSQL\15\bin
   ```
3. 将这个路径添加到系统PATH环境变量

**或者使用数据库工具**：
- 打开 pgAdmin 或 DBeaver
- 连接到 `device_monitor` 数据库
- 手动执行SQL文件：
  - `database\migrations\add_mock_data_table.sql`
  - `database\migrations\add_mock_management_menu.sql`

---

### 问题2：第2步后端启动失败

**可能原因**：
- 端口8001被占用
- Python环境问题
- 数据库连接失败

**解决方法**：

查看窗口中的错误信息：

1. 如果提示"端口已被占用"：
   - 关闭其他正在运行的后端服务
   - 或修改端口配置

2. 如果提示"模块未找到"：
   - 确认Python环境已激活
   - 运行：`pip install -r requirements.txt`

3. 如果提示数据库连接错误：
   - 检查PostgreSQL是否运行
   - 检查数据库配置是否正确

---

### 问题3：第4步显示"未登录"

**原因**：您还没有登录系统，或登录已过期

**解决方法**：

1. 打开系统页面：`http://localhost:3000`
2. 登录系统
3. **保持系统页面开着**（不要关闭）
4. 再打开 `init_mock_permissions.html`
5. 应该就能看到"✅ 已登录"了

---

### 问题4：找不到"Mock数据管理"菜单

**解决方法**：

1. **刷新页面**（按F5）
2. **重新登录**
3. **检查角色权限**：
   - 进入"角色管理"
   - 找到您的角色
   - 点击"分配权限"
   - 确认勾选了"Mock数据管理"菜单

4. **手动查看数据库**：
   ```sql
   -- 在psql或pgAdmin中执行
   SELECT id, name, path, menu_type, visible 
   FROM t_sys_menu 
   WHERE name = 'Mock数据管理';
   ```
   
   如果有结果，说明菜单已创建，可能是权限问题。

---

### 问题5：初始化权限时提示"请求失败"

**原因**：后端服务未运行或网络问题

**解决方法**：

1. **确认后端正在运行**：
   - 检查第2步的窗口是否还开着
   - 窗口中应该有日志在滚动

2. **测试后端是否正常**：
   - 浏览器访问：`http://localhost:8001/api/v2/health`
   - 应该看到JSON响应

3. **检查防火墙**：
   - 确认防火墙没有阻止8001端口

---

## 📞 还是不行？

如果以上都不能解决：

1. **截图以下信息**：
   - 每一步的错误提示
   - 浏览器控制台（按F12查看）
   - 后端窗口的错误信息

2. **记录这些信息**：
   - 在哪一步出错
   - 具体的错误信息
   - 您的操作系统版本
   - PostgreSQL版本

3. **联系技术支持**，提供上述信息

---

## 🎉 安装成功！

恭喜您完成安装！

接下来：

1. 📖 阅读 [使用指南](./MOCK_DATA_GUIDE.md) 了解如何使用
2. 🚀 阅读 [快速入门](./MOCK_QUICK_START.md) 创建第一个Mock规则
3. 💡 试试创建几个Mock规则，体验功能

**祝您使用愉快！** 🎊

