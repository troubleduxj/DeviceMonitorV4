# 移动端快速启动指南

> **DeviceMonitor Mobile - 快速启动参考**  
> NativeScript CLI 已配置完成 ✅

---

## ✅ 已完成的配置

### 1. NativeScript CLI 已安装

```json
// mobile/package.json
"devDependencies": {
  "nativescript": "~8.9.0"  // ✅ 已添加
}
```

**安装版本**: NativeScript CLI 8.9.3

### 2. 脚本已更新

所有脚本已更新为使用 `npx`，确保使用本地安装的 CLI：

```json
"scripts": {
  "android": "npx ns run android",
  "ios": "npx ns run ios",
  "clean": "npx ns clean",
  "build:android": "npx ns build android --release",
  "build:ios": "npx ns build ios --release"
}
```

---

## 🚀 现在可以运行了！

### 前置条件

在运行应用之前，需要准备以下之一：

#### 选项 A：Android 模拟器

1. **安装 Android Studio**
   - 下载：https://developer.android.com/studio
   
2. **创建虚拟设备 (AVD)**
   - 打开 Android Studio → AVD Manager
   - Create Virtual Device → Pixel 5 → API 33
   
3. **启动模拟器**
   - AVD Manager → 点击播放按钮

#### 选项 B：真实设备

1. **启用开发者选项**
   - 设置 → 关于手机 → 连续点击版本号 7 次
   
2. **启用 USB 调试**
   - 设置 → 开发者选项 → USB 调试
   
3. **连接设备**
   - 用 USB 线连接手机和电脑
   - 手机上允许 USB 调试

4. **验证连接**
   ```powershell
   adb devices
   # 应该显示你的设备
   ```

---

## 📱 运行应用

### 开发模式（热重载）

```powershell
# 确保在 mobile 目录
cd mobile

# 运行 Android 应用
pnpm android

# 首次运行会较慢（2-5 分钟）
# 后续热重载很快（1-3 秒）
```

### 查看日志

```powershell
# 终端会显示应用日志
# console.log() 的输出会显示在这里
```

### 重新构建

```powershell
# 如果遇到问题，清理缓存
pnpm clean

# 重新运行
pnpm android
```

---

## 🔍 调试

### Chrome DevTools

1. **运行应用**
   ```powershell
   cd mobile
   pnpm android
   ```

2. **打开 Chrome 调试**
   - 打开 Chrome 浏览器
   - 访问：`chrome://inspect`
   - 找到你的应用
   - 点击 **inspect**

3. **调试功能**
   - ✅ Console 日志
   - ✅ 网络请求
   - ✅ 断点调试
   - ✅ 性能分析

### ADB 日志

```powershell
# 查看所有日志
adb logcat

# 过滤应用日志
adb logcat | Select-String "DeviceMonitor"

# 清空日志
adb logcat -c
```

---

## 📋 可用命令

### 开发命令

| 命令 | 说明 |
|------|------|
| `pnpm android` | 运行 Android 应用（开发模式） |
| `pnpm ios` | 运行 iOS 应用（需要 macOS） |
| `pnpm clean` | 清理缓存和构建文件 |

### 构建命令

| 命令 | 说明 |
|------|------|
| `pnpm build:android` | 构建 Android 发布版 |
| `pnpm build:ios` | 构建 iOS 发布版 |

### 调试命令

| 命令 | 说明 |
|------|------|
| `adb devices` | 查看连接的设备 |
| `adb logcat` | 查看设备日志 |
| `npx ns doctor` | 检查开发环境 |

---

## ⚠️ 常见问题

### Q1: "Unable to apply changes on device" 错误

**解决方案**:
```powershell
cd mobile
pnpm clean
pnpm android
```

### Q2: 模拟器启动失败

**解决方案**:
1. 确保 BIOS 中启用了虚拟化（VT-x/AMD-V）
2. 安装 HAXM（Intel）或启用 Hypervisor（AMD）
3. 重启电脑

### Q3: "ns command not found" 错误

**解决方案**:
```powershell
# 已通过 npx 解决
# 所有脚本都使用 npx ns，无需全局安装
```

### Q4: 构建速度慢

**首次构建**: 2-5 分钟（正常）  
**热重载**: 1-3 秒（正常）

**加速技巧**:
- 使用 SSD
- 增加 RAM
- 关闭杀毒软件对项目目录的扫描

---

## 🎯 下一步

### 1. 检查开发环境

```powershell
# 运行 NativeScript 医生诊断
npx ns doctor
```

这会检查：
- ✅ Node.js 版本
- ✅ Android SDK
- ✅ Java JDK
- ✅ 环境变量

### 2. 安装 Android SDK（如果还没有）

参考：[移动端PC调试指南.md](./移动端PC调试指南.md)

### 3. 创建模拟器

参考：[移动端PC调试指南.md](./移动端PC调试指南.md) 第一部分

### 4. 运行应用

```powershell
cd mobile
pnpm android
```

---

## 📚 相关文档

- [移动端构建检查报告.md](./Mobile端构建检查报告.md) - 代码质量检查
- [移动端PC调试指南.md](./移动端PC调试指南.md) - 详细的环境配置
- [Mobile项目初始化-当前进度.md](./Mobile项目初始化-当前进度.md) - 项目进度

---

## ✅ 总结

**当前状态**: ✅ **准备就绪**

- ✅ NativeScript CLI 8.9.3 已安装
- ✅ 项目脚本已配置
- ✅ TypeScript 类型检查通过
- ✅ 所有依赖已安装

**下一步**: 
1. 安装 Android Studio（如果还没有）
2. 创建 AVD 模拟器
3. 运行 `pnpm android`

**需要帮助？**
- 查看 [移动端PC调试指南.md](./移动端PC调试指南.md)
- 运行 `npx ns doctor` 检查环境

---

**Happy Coding! 🚀**

