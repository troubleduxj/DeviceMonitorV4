# 08 - 前端菜单规划建议

[← 返回总览](./00-设计方案总览.md)

---

## 📋 现有菜单结构分析

### 当前一级菜单

根据代码调研（`web/src/views/`），系统现有一级菜单：

| 一级菜单 | 路径 | 功能说明 | 二级菜单数 |
|---------|------|---------|-----------|
| **监控看板** | `/dashboard` | 设备运行监控看板 | 3 |
| **设备管理** | `/device` | 设备信息、类型管理 | 2 |
| **设备维护** | `/device-maintenance` | 维修记录、维护看板 | 2 |
| **设备监控** | `/device-monitor` | 实时监控、历史数据 | 2 |
| **AI监测** | `/ai-monitor` | AI智能监测分析 | 7 |
| **报警管理** | `/alarm` | 报警信息、报警分析 | 2 |
| **统计报表** | `/statistics` | 各类统计报表 | 5 |
| **流程管理** | `/process` | 流程卡片管理 | 1 |
| **流程设置** | `/flow-settings` | 工作流设计器 | 3 |
| **系统管理** | `/system` | 用户、角色、权限等 | 10+ |

**总计**: 10个一级菜单

---

## 💡 菜单规划方案对比

### 方案A: 新增一级菜单"数据模型管理" ⭐ 推荐

#### 菜单结构

```
📊 数据模型管理 (/data-model)
  ├─ 📝 字段定义管理 (/data-model/fields)
  │   └─ 管理各设备类型的字段定义
  ├─ 🎨 数据模型配置 (/data-model/models)
  │   ├─ 实时监控模型
  │   ├─ 统计分析模型
  │   └─ AI特征模型
  ├─ 🔗 字段映射管理 (/data-model/mappings)
  │   └─ 管理字段与TDengine的映射关系
  ├─ 🔍 数据查询工具 (/data-model/query)
  │   └─ 基于模型的动态数据查询
  └─ 📊 模型执行日志 (/data-model/logs)
      └─ 查看模型执行历史和性能
```

#### 菜单位置建议

```
📊 监控看板
📱 设备管理
🔧 设备维护
📡 设备监控
🤖 AI监测
⭐ 数据模型管理  ← 新增（推荐在AI监测后）
⚠️ 报警管理
📈 统计报表
🔄 流程管理
🔄 流程设置
⚙️ 系统管理
```

**定位**: 在"AI监测"和"报警管理"之间

#### 优势 ✅

1. **功能聚合明确**
   - 所有元数据和模型配置功能集中在一起
   - 用户路径清晰：`设备管理` → `数据模型管理` → `AI监测`
   - 符合"配置 → 使用"的逻辑流程

2. **便于权限控制**
   - 独立的权限组：`data-model:read`, `data-model:write`
   - 可以整体授权给"数据管理员"角色
   - 与业务操作（设备管理、监控）分离

3. **扩展性强**
   - 未来可以添加更多元数据管理功能
   - 例如：数据字典、数据质量管理、数据血缘等
   - 成为完整的数据治理平台入口

4. **降低学习成本**
   - 新功能集中在一个菜单，容易发现
   - 功能层次清晰，不会迷失在现有复杂菜单中
   - 符合用户"配置中心"的心智模型

5. **不影响现有用户**
   - 现有菜单保持不变
   - 新增的菜单可以通过权限控制隐藏
   - 对不需要这些功能的用户无感知

#### 劣势 ⚠️

1. **增加菜单数量**
   - 一级菜单从10个变成11个
   - 可能需要优化菜单布局（如收起/展开）

2. **需要用户培训**
   - 需要告知用户新菜单的作用
   - 需要提供使用文档和视频教程

#### 适用场景 🎯

- ✅ **元数据功能是核心特性**
- ✅ **有专门的数据管理团队**
- ✅ **需要频繁配置和调整数据模型**
- ✅ **未来会扩展更多数据治理功能**

---

### 方案B: 集成到现有"设备管理"菜单

#### 菜单结构

```
📱 设备管理 (/device)
  ├─ 📋 设备信息 (/device/baseinfo)
  ├─ 📁 设备类型 (/device/type)
  ├─ ⭐ 字段配置 (/device/fields) ← 新增
  ├─ ⭐ 模型配置 (/device/models) ← 新增
  └─ ⭐ 数据查询 (/device/query) ← 新增
```

#### 优势 ✅

1. **菜单数量不增加**
   - 保持10个一级菜单
   - 菜单结构简洁

2. **逻辑关联紧密**
   - 字段配置、模型配置与设备类型紧密相关
   - 在设备类型页面可以直接跳转到配置

3. **用户路径短**
   - 从设备类型直接配置模型
   - 减少菜单层级跳转

#### 劣势 ⚠️

1. **功能定位不清**
   - "设备管理"更偏向业务操作（CRUD设备）
   - 元数据配置是技术配置，放在一起可能混淆

2. **权限控制复杂**
   - 设备管理和元数据配置需要不同权限
   - 可能出现"能管理设备，但不能配置模型"的情况

3. **二级菜单过多**
   - 设备管理下已有2个二级菜单
   - 再增加3个，变成5个，可能过于拥挤

4. **扩展性受限**
   - 难以添加数据治理相关功能
   - 容易让"设备管理"菜单变成"大杂烩"

#### 适用场景 🎯

- ✅ **元数据功能是辅助特性**
- ✅ **只有少数管理员使用**
- ✅ **不计划扩展更多数据功能**

---

### 方案C: 集成到现有"AI监测"菜单

#### 菜单结构

```
🤖 AI监测 (/ai-monitor)
  ├─ 📊 AI监控看板 (/ai-monitor/dashboard)
  ├─ 🚨 异常检测 (/ai-monitor/anomaly-detection)
  ├─ 💚 健康评分 (/ai-monitor/health-scoring)
  ├─ 📈 趋势预测 (/ai-monitor/trend-prediction)
  ├─ ⭐ AI特征配置 (/ai-monitor/features) ← 新增
  ├─ ⭐ 数据模型管理 (/ai-monitor/models) ← 新增
  ├─ 🧠 模型管理 (/ai-monitor/model-management)
  ├─ 📝 数据标注 (/ai-monitor/data-annotation)
  └─ 💬 智能分析 (/ai-monitor/smart-analysis)
```

#### 优势 ✅

1. **功能关联性强**
   - AI特征提取直接服务于AI监测
   - 数据模型配置为AI提供数据基础

2. **符合AI工程师工作流**
   - AI工程师在AI监测菜单下完成所有工作
   - 配置特征 → 训练模型 → 监测分析 一站式

#### 劣势 ⚠️

1. **职责不清**
   - 元数据管理不仅服务AI，也服务实时监控、统计分析
   - 放在AI下会让其他用户难以发现

2. **二级菜单过多**
   - AI监测已有7个二级菜单
   - 再增加2个，变成9个，严重过载

3. **权限混乱**
   - 数据管理员可能需要配置模型，但不需要访问AI监测
   - 权限边界模糊

#### 适用场景 🎯

- ✅ **功能主要服务AI**
- ⚠️ **不推荐**（二级菜单过多，职责不清）

---

### 方案D: 放入"系统管理"菜单

#### 菜单结构

```
⚙️ 系统管理 (/system)
  ├─ 👥 用户管理
  ├─ 🎭 角色管理
  ├─ 📋 菜单管理
  ├─ 🔐 权限配置
  ├─ ⭐ 数据模型管理 (/system/data-models) ← 新增
  └─ ... (其他10+个二级菜单)
```

#### 优势 ✅

1. **符合"配置"定位**
   - 系统管理通常包含各种配置功能
   - 元数据配置属于系统级配置

2. **权限管理方便**
   - 系统管理员自然有权限配置数据模型

#### 劣势 ⚠️

1. **二级菜单严重过载**
   - 系统管理已有10+个二级菜单
   - 再增加会让用户无所适从

2. **功能不易被发现**
   - 业务用户不会去系统管理找数据模型
   - 容易被埋没

3. **角色定位冲突**
   - 系统管理员 ≠ 数据管理员
   - 权限职责混乱

#### 适用场景 🎯

- ⚠️ **不推荐**（二级菜单过多，不易发现）

---

## 🎯 推荐方案

### ⭐ 推荐：方案A - 新增一级菜单"数据模型管理"

#### 推荐理由

1. **战略定位清晰**
   - 元数据驱动是系统架构升级的核心特性
   - 应该有与其价值相匹配的入口和地位

2. **用户体验最优**
   - 功能聚合，容易发现和使用
   - 学习路径清晰
   - 符合"配置中心"心智模型

3. **扩展性最强**
   - 未来可以成为完整的数据治理平台
   - 可以集成数据质量、数据血缘、数据字典等功能

4. **权限控制清晰**
   - 独立的权限域
   - 可以精细化授权

5. **不影响现有功能**
   - 现有菜单保持不变
   - 新功能独立演进

#### 实施建议

##### 1. 菜单层次设计

```
📊 数据模型管理
  ├─ 📝 字段定义管理
  │   ├─ 字段列表（按设备类型筛选）
  │   ├─ 新增/编辑字段
  │   ├─ 批量导入
  │   └─ 字段使用统计
  │
  ├─ 🎨 数据模型配置
  │   ├─ 模型列表
  │   ├─ 创建模型（选择类型：实时/统计/AI）
  │   ├─ 模型配置器（可视化配置界面）
  │   ├─ SQL预览和测试
  │   └─ 模型版本管理
  │
  ├─ 🔗 字段映射管理
  │   ├─ 映射列表
  │   ├─ 新增映射
  │   ├─ 映射验证工具
  │   └─ TDengine表结构查看
  │
  ├─ 🔍 数据查询工具
  │   ├─ 选择数据模型
  │   ├─ 设置查询条件
  │   ├─ 查询结果展示
  │   └─ 数据导出
  │
  └─ 📊 模型执行日志
      ├─ 执行历史
      ├─ 性能统计
      └─ 错误日志
```

##### 2. 菜单图标和顺序

```javascript
// web/src/router/index.js
{
  path: '/data-model',
  name: 'DataModel',
  component: Layout,
  meta: {
    title: '数据模型管理',
    icon: 'carbon:data-structured',  // 推荐图标
    order: 6,  // 在AI监测(5)之后，报警管理(7)之前
    roles: ['data-admin', 'admin'],  // 权限角色
    badge: 'NEW'  // 新功能徽章（可选，上线后3个月移除）
  },
  children: [...]
}
```

##### 3. 快捷入口设计

为了降低用户学习成本，在相关页面添加快捷入口：

**A. 设备类型管理页面**
```vue
<!-- web/src/views/device/type/index.vue -->
<template>
  <n-card title="设备类型列表">
    <template #header-extra>
      <n-button type="primary" @click="goToModelConfig">
        <template #icon>
          <n-icon><SettingsIcon /></n-icon>
        </template>
        配置数据模型
      </n-button>
    </template>
    
    <n-data-table>
      <n-table-column #default="{ row }">
        <n-button text @click="goToModelConfig(row.type_code)">
          配置
        </n-button>
      </n-table-column>
    </n-data-table>
  </n-card>
</template>
```

**B. AI监测看板**
```vue
<!-- web/src/views/ai-monitor/dashboard/index.vue -->
<template>
  <n-card title="AI监控看板">
    <n-alert type="info" closable>
      <template #icon>
        <n-icon><TipIcon /></n-icon>
      </template>
      想要调整AI特征？
      <n-button text type="primary" @click="goToFeatureConfig">
        前往AI特征配置 →
      </n-button>
    </n-alert>
  </n-card>
</template>
```

**C. 统计报表页面**
```vue
<!-- web/src/views/statistics/index.vue -->
<template>
  <n-card title="统计报表">
    <n-alert type="info" closable>
      <template #icon>
        <n-icon><TipIcon /></n-icon>
      </template>
      需要自定义统计指标？
      <n-button text type="primary" @click="goToModelConfig">
        配置统计模型 →
      </n-button>
    </n-alert>
  </n-card>
</template>
```

##### 4. 首页引导卡片

```vue
<!-- web/src/views/workbench/index.vue -->
<template>
  <n-grid :cols="3">
    <!-- 现有卡片 -->
    
    <!-- 新增：数据模型管理入口 -->
    <n-grid-item>
      <n-card class="feature-card" hoverable @click="goToDataModel">
        <div class="card-content">
          <n-icon size="48" color="#1890ff">
            <DataStructuredIcon />
          </n-icon>
          <h3>数据模型管理</h3>
          <p>配置设备数据模型，支持实时监控、统计分析和AI特征提取</p>
          <n-tag type="success" size="small">NEW</n-tag>
        </div>
      </n-card>
    </n-grid-item>
  </n-grid>
</template>

<style scoped>
.feature-card {
  border: 2px solid transparent;
  transition: all 0.3s;
}

.feature-card:hover {
  border-color: #1890ff;
  box-shadow: 0 4px 12px rgba(24, 144, 255, 0.15);
}
</style>
```

##### 5. 权限配置

```javascript
// 新增权限点
const dataModelPermissions = {
  'data-model:view': '查看数据模型',
  'data-model:field:create': '创建字段定义',
  'data-model:field:update': '修改字段定义',
  'data-model:field:delete': '删除字段定义',
  'data-model:model:create': '创建数据模型',
  'data-model:model:update': '修改数据模型',
  'data-model:model:delete': '删除数据模型',
  'data-model:model:test': '测试数据模型',
  'data-model:mapping:manage': '管理字段映射',
  'data-model:query:execute': '执行数据查询',
  'data-model:log:view': '查看执行日志'
}

// 推荐角色配置
const roles = {
  'data-admin': {
    name: '数据管理员',
    permissions: [
      'data-model:*',  // 所有数据模型权限
      'device:type:view',  // 查看设备类型
      'ai-monitor:view'  // 查看AI监测
    ]
  },
  'data-analyst': {
    name: '数据分析师',
    permissions: [
      'data-model:view',
      'data-model:model:create',  // 可以创建模型
      'data-model:model:update',  // 可以修改自己的模型
      'data-model:query:execute'  // 可以查询数据
      // 但不能删除模型，不能管理字段映射
    ]
  },
  'ai-engineer': {
    name: 'AI工程师',
    permissions: [
      'data-model:view',
      'data-model:model:create',  // 创建AI模型
      'data-model:field:update',  // 配置AI特征标识
      'data-model:query:execute',
      'ai-monitor:*'  // 所有AI监测权限
    ]
  }
}
```

##### 6. 新手引导

```vue
<!-- 使用driver.js或intro.js实现新手引导 -->
<script setup>
import { driver } from 'driver.js'
import 'driver.js/dist/driver.css'

const startGuide = () => {
  const driverObj = driver({
    showProgress: true,
    steps: [
      {
        element: '#data-model-menu',
        popover: {
          title: '数据模型管理',
          description: '在这里可以配置设备数据模型，支持实时监控、统计分析和AI特征提取',
          position: 'right'
        }
      },
      {
        element: '#field-management',
        popover: {
          title: '字段定义管理',
          description: '定义设备的数据字段，包括字段类型、单位、验证规则等',
          position: 'bottom'
        }
      },
      {
        element: '#model-config',
        popover: {
          title: '数据模型配置',
          description: '创建不同用途的数据模型：实时监控模型、统计分析模型、AI特征模型',
          position: 'bottom'
        }
      },
      {
        element: '#query-tool',
        popover: {
          title: '数据查询工具',
          description: '基于配置的模型，快速查询和导出数据',
          position: 'bottom'
        }
      }
    ]
  })
  
  driverObj.drive()
}

// 首次访问时自动触发引导
onMounted(() => {
  const hasSeenGuide = localStorage.getItem('data-model-guide-seen')
  if (!hasSeenGuide) {
    startGuide()
    localStorage.setItem('data-model-guide-seen', 'true')
  }
})
</script>
```

---

## 📱 移动端适配建议

如果系统有移动端，建议：

1. **移动端隐藏"数据模型管理"菜单**
   - 元数据配置通常在PC端进行
   - 移动端只展示业务操作菜单

2. **提供"查看配置"只读功能**
   - 移动端可以查看当前使用的模型配置
   - 但不能修改

---

## 🎨 UI/UX设计建议

### 1. 菜单图标选择

推荐图标库：`@iconify/vue` (carbon图标集)

```javascript
// 推荐图标
{
  '数据模型管理': 'carbon:data-structured',
  '字段定义': 'carbon:cloud-data-ops',
  '模型配置': 'carbon:model-builder',
  '字段映射': 'carbon:data-share',
  '数据查询': 'carbon:data-view',
  '执行日志': 'carbon:analytics-custom'
}
```

### 2. 配色方案

```css
/* 数据模型管理主题色 */
:root {
  --data-model-primary: #1890ff;    /* 主色调：蓝色（数据感） */
  --data-model-success: #52c41a;    /* 成功：绿色 */
  --data-model-warning: #faad14;    /* 警告：橙色 */
  --data-model-error: #ff4d4f;      /* 错误：红色 */
  --data-model-info: #1890ff;       /* 信息：蓝色 */
}
```

### 3. 页面布局

采用统一的三栏布局：

```
┌─────────────────────────────────────────────────────────┐
│ Header: 面包屑导航 + 操作按钮                            │
├──────────┬───────────────────────────┬───────────────────┤
│          │                           │                   │
│  左侧    │      中间内容区            │   右侧            │
│  筛选栏  │                           │   预览/帮助       │
│          │   - 表格                  │                   │
│  - 类型  │   - 表单                  │   - SQL预览       │
│  - 分类  │   - 可视化配置器          │   - 字段说明      │
│  - 状态  │                           │   - 快捷帮助      │
│          │                           │                   │
└──────────┴───────────────────────────┴───────────────────┘
```

---

## 📈 上线策略

### 阶段1: 软上线（第1-2周）

- ✅ 菜单默认隐藏，只对特定角色开放
- ✅ 内部测试和收集反馈
- ✅ 完善文档和视频教程

### 阶段2: 灰度发布（第3-4周）

- ✅ 向部分用户开放（按部门或角色）
- ✅ 收集使用数据和反馈
- ✅ 优化用户体验

### 阶段3: 全量发布（第5周）

- ✅ 向所有用户开放
- ✅ 首页展示新功能引导卡片
- ✅ 发布公告和培训材料

### 阶段4: 持续优化（第6周+）

- ✅ 根据用户反馈持续迭代
- ✅ 收集使用数据，优化功能
- ✅ 规划下一阶段功能

---

## 📊 效果评估指标

### 可用性指标

- **功能发现率**: 新功能上线后，多少用户发现并访问？
  - 目标: 70%+ 的目标用户在2周内访问

- **使用频率**: 用户多久使用一次？
  - 目标: 数据管理员每周至少使用1次

- **任务完成率**: 用户能否顺利完成配置任务？
  - 目标: 90%+ 的用户能独立完成模型配置

### 性能指标

- **页面加载时间**: < 1秒
- **配置保存时间**: < 2秒
- **查询响应时间**: < 3秒

### 业务价值指标

- **新设备类型上线时间**: 从2周缩短到2天
- **字段修改时间**: 从1天缩短到10分钟
- **AI数据准备时间**: 从3天缩短到1小时

---

## 🎓 用户培训建议

### 培训对象

1. **数据管理员** (必须参加)
   - 完整培训（2小时）
   - 包含所有功能模块

2. **数据分析师** (建议参加)
   - 重点培训（1小时）
   - 专注数据查询和模型配置

3. **AI工程师** (建议参加)
   - 专题培训（1小时）
   - 专注AI特征配置

### 培训内容

1. **理论部分（30分钟）**
   - 元数据驱动架构介绍
   - 数据模型的概念和价值
   - 使用场景和最佳实践

2. **实操部分（1小时）**
   - 创建字段定义
   - 配置数据模型（实时/统计/AI）
   - 测试和验证模型
   - 使用数据查询工具

3. **答疑部分（30分钟）**
   - 现场答疑
   - 常见问题解答

### 培训材料

- ✅ PPT课件
- ✅ 操作手册（PDF）
- ✅ 视频教程（5-10分钟/个）
- ✅ 常见问题FAQ
- ✅ 最佳实践案例

---

## 📝 总结

### 最终推荐

**⭐ 强烈推荐方案A：新增一级菜单"数据模型管理"**

### 关键理由

1. **战略定位** - 元数据驱动是核心架构升级，需要独立入口
2. **用户体验** - 功能聚合，易于发现和使用
3. **扩展性** - 为未来数据治理功能预留空间
4. **权限清晰** - 独立权限域，便于管理

### 实施要点

1. ✅ 菜单位置：AI监测之后，报警管理之前
2. ✅ 添加快捷入口：在设备管理、AI监测等相关页面
3. ✅ 新手引导：首次访问自动触发引导
4. ✅ 灰度发布：先内测，再灰度，最后全量
5. ✅ 持续优化：收集反馈，迭代改进

### 风险控制

- ✅ 可以通过权限控制隐藏新菜单
- ✅ 不影响现有功能和用户
- ✅ 如果效果不佳，可以调整为方案B

---

[← 返回总览](./00-设计方案总览.md) | [查看整合方案 →](./07-现有功能整合方案.md)

