# 数据模型管理 - 三模块快速参考

> 💡 这是简化版参考，详细说明请查看《数据模型管理三模块使用指南.md》

---

## 📊 三模块对比表

| 模块 | 作用 | 操作对象 | 必需性 | 使用频率 |
|------|------|---------|--------|---------|
| **字段定义管理** | 定义字段是什么 | 字段概念 | ✅ 必需 | ⭐⭐⭐⭐⭐ |
| **字段映射管理** | 定义字段在哪里 | 字段-列映射 | ⚠️ 按需 | ⭐⭐⭐ |
| **模型配置管理** | 定义字段怎么用 | 字段组合 | ✅ 必需 | ⭐⭐⭐⭐⭐ |

---

## 🎯 一句话说明

```
字段定义管理：创建"平均电流"字段，类型float，单位A
         ↓
字段映射管理：映射到 TDengine.weld_data.avg_current
         ↓
模型配置管理：组合"平均电流+平均电压+..."成"实时监控模型"
```

---

## 🚀 快速开始（3步法）

### 新设备接入最快流程（15分钟）

```bash
# 步骤1: 同步字段定义（5分钟）
打开: 字段定义管理 → 点击"从TDengine同步"
配置: 设备类型 + 数据库 + 超级表
结果: 自动创建所有字段 ✓

# 步骤2: (可选)创建映射
打开: 字段映射管理 → 按需创建
用途: 字段名≠列名 或 需要数据转换

# 步骤3: 创建模型（5分钟）
打开: 模型配置管理 → 新建模型
选择: 需要的字段
保存: 完成 ✓
```

---

## 📋 使用决策树

```
开始
  │
  ├─ 有TDengine超级表吗？
  │   ├─ 是 → 使用"从TDengine同步"创建字段定义
  │   └─ 否 → 手动创建字段定义
  │
  ├─ 字段名和列名一致吗？
  │   ├─ 是 → 跳过字段映射（可选）
  │   └─ 否 → 创建字段映射
  │
  ├─ 需要数据转换吗？
  │   ├─ 是 → 必须创建字段映射+配置转换规则
  │   └─ 否 → 继续
  │
  └─ 创建数据模型
      └─ 选择需要的字段 → 完成 ✓
```

---

## 💡 常见问题速查

| 问题 | 答案 |
|------|------|
| **三个都要配置吗？** | 最少需要：字段定义 + 模型配置 |
| **映射什么时候需要？** | 列名不同 或 需要转换 或 精确控制 |
| **同步后还要编辑吗？** | 是，需补充单位、阈值等业务属性 |
| **一个字段能有多个映射吗？** | 可以，不同超级表可以创建不同映射 |
| **修改字段影响数据吗？** | 不影响，只改元数据 |
| **能批量操作吗？** | 同步字段可批量，映射需逐个创建 |

---

## 🎓 实战示例

### 示例1：简单场景（字段名=列名）

```
场景：TDengine的weld_data表，列名和字段名完全一致

✓ 字段定义：
  - avg_current (平均电流)
  - avg_voltage (平均电压)

✗ 字段映射：跳过（可选）

✓ 模型配置：
  - 选择 avg_current, avg_voltage
  - 系统自动按名称匹配

结果：正常工作 ✓
```

### 示例2：需要转换（字段名≠列名）

```
场景：TDengine存储开尔文温度，业务需要摄氏度

✓ 字段定义：
  - temperature (温度, ℃)

✓ 字段映射：
  - 列名：temp_kelvin
  - 转换：Expression
  - 表达式：{temp_kelvin} - 273.15

✓ 模型配置：
  - 选择 temperature
  - 查询时自动转换

结果：显示为摄氏度 ✓
```

---

## 🔑 关键概念

### 层次关系

```
物理层 (TDengine)
    weld_data.avg_current (列)
           ↑
        映射关系
           ↓
逻辑层 (PostgreSQL)
    avg_current (字段定义)
           ↑
        组合关系
           ↓
应用层 (业务)
    实时监控模型
```

### 数据流向

```
写入：设备 → TDengine
查询：模型 → 字段定义 → (映射) → TDengine → 数据
```

---

## 📖 配置检查清单

### 新设备接入检查

- [ ] 字段定义已创建（同步或手动）
- [ ] 字段属性已完善（单位、阈值）
- [ ] 字段映射已创建（如需）
- [ ] 转换规则已配置（如需）
- [ ] 数据模型已创建
- [ ] 字段已选择到模型
- [ ] 模型已激活
- [ ] 测试查询成功

---

## 🎯 最佳实践速记

| 实践 | 说明 |
|------|------|
| **优先同步** | 使用"从TDengine同步"而非手动创建 |
| **完善属性** | 同步后补充单位、阈值等业务信息 |
| **按需映射** | 简单场景可跳过，复杂场景必须配 |
| **多个模型** | 不同场景创建不同模型（实时、统计、AI）|
| **定期维护** | 字段扩展时重新同步 |
| **测试验证** | 使用"预览与测试"页面验证 |

---

## 📞 获取帮助

- 详细文档：`数据模型管理三模块使用指南.md`
- TDengine同步：`TDengine字段同步功能说明.md`
- 前端集成：`TDengine字段同步-前端集成说明.md`

---

**版本**: 1.0 | **更新**: 2025-11-06

