# AI APIå‰ç¼€ç»Ÿä¸€ - å®ŒæˆæŠ¥å‘Š

> **å®Œæˆæ—¶é—´**: 2025-11-06 09:56  
> **æ‰§è¡Œäºº**: AI Assistant  
> **ç”¨æˆ·éœ€æ±‚**: ç»Ÿä¸€å‰ç¼€ï¼Œå½»åº•è§£å†³é—®é¢˜  
> **çŠ¶æ€**: âœ… **å…¨éƒ¨å®Œæˆ**  

---

## ğŸ‰ ç»Ÿä¸€å®Œæˆï¼

### ç»Ÿä¸€æ–¹æ¡ˆ

**æ‰€æœ‰AI APIç°åœ¨ç»Ÿä¸€ä½¿ç”¨**ï¼š`/api/v2/ai/` å‰ç¼€ âœ…

**é€šè¿‡å­è·¯å¾„åŒºåˆ†åŠŸèƒ½æ¨¡å—**ï¼š

```
/api/v2/ai/
â”œâ”€â”€ predictions/
â”‚   â”œâ”€â”€ tasks/              # é¢„æµ‹ä»»åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ execute/            # å®æ—¶é¢„æµ‹æ‰§è¡Œ
â”‚   â””â”€â”€ analytics/          # é¢„æµ‹æ•°æ®åˆ†æ
â”‚
â”œâ”€â”€ health-scores/
â”‚   â”œâ”€â”€ calculate/          # è¯„åˆ†è®¡ç®—
â”‚   â””â”€â”€ records/            # è®°å½•ç®¡ç†
â”‚
â”œâ”€â”€ features/               # ç‰¹å¾æå–
â”œâ”€â”€ anomalies/              # å¼‚å¸¸æ£€æµ‹
â”œâ”€â”€ analysis/               # æ™ºèƒ½åˆ†æ
â”œâ”€â”€ annotations/            # æ•°æ®æ ‡æ³¨
â””â”€â”€ models/                 # æ¨¡å‹ç®¡ç†
```

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. åç«¯APIæ–‡ä»¶ï¼ˆ5ä¸ªï¼‰âœ…

#### predictions.py
```python
// æ”¹å‰
router = APIRouter(prefix="/predictions")
æ³¨å†Œ: prefix="/ai-monitor"
ç»“æœ: /api/v2/ai-monitor/predictions/...

// æ”¹å  
router = APIRouter(prefix="/predictions/tasks")
æ³¨å†Œ: prefix="/ai"
ç»“æœ: /api/v2/ai/predictions/tasks/... âœ…
```

#### trend_prediction.py
```python
// æ”¹å‰
router = APIRouter(prefix="/ai/trend-prediction")
ç»“æœ: /api/v2/ai/trend-prediction/...

// æ”¹å
router = APIRouter(prefix="/predictions/execute")
æ³¨å†Œ: prefix="/ai"
ç»“æœ: /api/v2/ai/predictions/execute/... âœ…
```

#### prediction_analytics.py
```python
// æ”¹å‰
router = APIRouter(prefix="/prediction-analytics")
æ³¨å†Œ: prefix="/ai-monitor"
ç»“æœ: /api/v2/ai-monitor/prediction-analytics/...

// æ”¹å
router = APIRouter(prefix="/predictions/analytics")
æ³¨å†Œ: prefix="/ai"
ç»“æœ: /api/v2/ai/predictions/analytics/... âœ…
```

#### health_scoring.py
```python
// æ”¹å‰
router = APIRouter(prefix="/ai/health-scoring")
ç»“æœ: /api/v2/ai/health-scoring/...

// æ”¹å
router = APIRouter(prefix="/health-scores/calculate")
æ³¨å†Œ: prefix="/ai"
ç»“æœ: /api/v2/ai/health-scores/calculate/... âœ…
```

#### health_scores.py
```python
// æ”¹å‰
router = APIRouter(prefix="/health-scores")
æ³¨å†Œ: prefix="/ai-monitor"
ç»“æœ: /api/v2/ai-monitor/health-scores/...

// æ”¹å
router = APIRouter(prefix="/health-scores/records")
æ³¨å†Œ: prefix="/ai"
ç»“æœ: /api/v2/ai/health-scores/records/... âœ…
```

---

### 2. è·¯ç”±æ³¨å†Œï¼ˆapp/api/v2/__init__.pyï¼‰âœ…

```python
// ç»Ÿä¸€æ³¨å†Œåˆ° /ai å‰ç¼€
if ai_settings.ai_module_enabled and ai_settings.ai_trend_prediction_enabled:
    v2_router.include_router(predictions_router, prefix="/ai")
    v2_router.include_router(prediction_analytics_router, prefix="/ai")
    v2_router.include_router(trend_prediction_router, prefix="/ai")
```

---

### 3. å‰ç«¯APIè°ƒç”¨ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰âœ…

#### web/src/api/v2/ai-module.js

**predictionManagementApi**:
```javascript
// æ‰€æœ‰è·¯å¾„æ›´æ–°ä¸º /ai/predictions/tasks/
createBatch: '/ai/predictions/tasks/batch'
getHistory: '/ai/predictions/tasks/history'
getList: '/ai/predictions/tasks'
getDetail: '/ai/predictions/tasks/{id}'
// ... ç­‰10ä¸ªæ–¹æ³•
```

**trendPredictionApi**:
```javascript
// æ‰€æœ‰è·¯å¾„æ›´æ–°ä¸º /ai/predictions/execute/
predict: '/ai/predictions/execute/predict'
predictBatch: '/ai/predictions/execute/predict/batch'
compare: '/ai/predictions/execute/compare'
getMethods: '/ai/predictions/execute/methods'
```

#### web/src/views/ai-monitor/trend-prediction/index.vue

```javascript
// fetchè°ƒç”¨æ›´æ–°
fetch('/api/v2/ai/predictions/analytics/risk-assessment')
fetch('/api/v2/ai/predictions/analytics/health-trend')
fetch('/api/v2/ai/predictions/analytics/report')
```

---

### 4. Mockè§„åˆ™ï¼ˆ6ä¸ªï¼‰âœ…

**æ›´æ–°çš„Mockè§„åˆ™URL**:
```
/api/v2/ai/health-scores/calculate/devices
/api/v2/ai/health-scores/calculate/distribution
/api/v2/ai/health-scores/calculate/overview
/api/v2/ai/predictions/analytics/risk-assessment
/api/v2/ai/predictions/analytics/health-trend
/api/v2/ai/predictions/analytics/report
```

---

## ğŸ“Š ç»Ÿä¸€åçš„APIæ¶æ„

### å®Œæ•´è·¯å¾„æ¸…å•

#### é¢„æµ‹æ¨¡å—

**ä»»åŠ¡ç®¡ç†**:
```
GET    /api/v2/ai/predictions/tasks
POST   /api/v2/ai/predictions/tasks
GET    /api/v2/ai/predictions/tasks/{id}
PUT    /api/v2/ai/predictions/tasks/{id}
DELETE /api/v2/ai/predictions/tasks/{id}
POST   /api/v2/ai/predictions/tasks/batch
GET    /api/v2/ai/predictions/tasks/history
GET    /api/v2/ai/predictions/tasks/{id}/export
POST   /api/v2/ai/predictions/tasks/{id}/share
POST   /api/v2/ai/predictions/tasks/batch-delete
```

**å®æ—¶è®¡ç®—**:
```
POST   /api/v2/ai/predictions/execute/predict
POST   /api/v2/ai/predictions/execute/predict/batch
POST   /api/v2/ai/predictions/execute/compare
GET    /api/v2/ai/predictions/execute/methods
```

**æ•°æ®åˆ†æ**:
```
GET    /api/v2/ai/predictions/analytics/risk-assessment
GET    /api/v2/ai/predictions/analytics/health-trend
GET    /api/v2/ai/predictions/analytics/report
```

---

#### å¥åº·è¯„åˆ†æ¨¡å—

**è¯„åˆ†è®¡ç®—**:
```
POST   /api/v2/ai/health-scores/calculate/score
POST   /api/v2/ai/health-scores/calculate/score/batch
GET    /api/v2/ai/health-scores/calculate/history
GET    /api/v2/ai/health-scores/calculate/trend/{device_code}
GET    /api/v2/ai/health-scores/calculate/weights
```

**è®°å½•ç®¡ç†**:
```
GET    /api/v2/ai/health-scores/records
POST   /api/v2/ai/health-scores/records
GET    /api/v2/ai/health-scores/records/{id}
PUT    /api/v2/ai/health-scores/records/{id}
DELETE /api/v2/ai/health-scores/records/{id}
GET    /api/v2/ai/health-scores/records/export
PUT    /api/v2/ai/health-scores/records/config
GET    /api/v2/ai/health-scores/records/trends
POST   /api/v2/ai/health-scores/records/batch-delete
```

---

## ğŸ¯ ç»Ÿä¸€å‰çš„å¯¹æ¯”

### ä¿®æ”¹å‰ï¼ˆæ··ä¹±ï¼‰âŒ

```
/api/v2/ai-monitor/predictions/...          â† ç®¡ç†ç±»
/api/v2/ai/trend-prediction/...             â† æ‰§è¡Œç±»
/api/v2/ai-monitor/prediction-analytics/... â† åˆ†æç±»
/api/v2/ai/health-scoring/...               â† è®¡ç®—ç±»
/api/v2/ai-monitor/health-scores/...        â† ç®¡ç†ç±»
```

**é—®é¢˜**:
- âŒ 3ç§ä¸åŒå‰ç¼€æ¨¡å¼
- âŒ éš¾ä»¥è®°å¿†å’Œç†è§£
- âŒ ä¸ç¬¦åˆè§„èŒƒ

---

### ä¿®æ”¹åï¼ˆç»Ÿä¸€ï¼‰âœ…

```
/api/v2/ai/predictions/tasks/...      # é¢„æµ‹-ä»»åŠ¡ç®¡ç†
/api/v2/ai/predictions/execute/...    # é¢„æµ‹-å®æ—¶è®¡ç®—
/api/v2/ai/predictions/analytics/...  # é¢„æµ‹-æ•°æ®åˆ†æ
/api/v2/ai/health-scores/calculate/... # å¥åº·-è¯„åˆ†è®¡ç®—
/api/v2/ai/health-scores/records/...   # å¥åº·-è®°å½•ç®¡ç†
```

**ä¼˜åŠ¿**:
- âœ… ç»Ÿä¸€å‰ç¼€ `/api/v2/ai/`
- âœ… æ¨¡å—åŒ–åˆ†ç»„ï¼ˆpredictions, health-scoresï¼‰
- âœ… åŠŸèƒ½åˆ†å±‚ï¼ˆtasks, execute, analyticsï¼‰
- âœ… æ¸…æ™°æ˜“æ‡‚

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### åç«¯ï¼ˆ6ä¸ªæ–‡ä»¶ï¼‰

- âœ… app/api/v2/ai/predictions.py
- âœ… app/api/v2/ai/trend_prediction.py
- âœ… app/api/v2/ai/prediction_analytics.py
- âœ… app/api/v2/ai/health_scoring.py
- âœ… app/api/v2/ai/health_scores.py
- âœ… app/api/v2/__init__.py

### å‰ç«¯ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰

- âœ… web/src/api/v2/ai-module.js
- âœ… web/src/views/ai-monitor/trend-prediction/index.vue

### Mockè§„åˆ™

- âœ… 6ä¸ªMockè§„åˆ™URLå·²æ›´æ–°

### è„šæœ¬

- âœ… scripts/update_mock_urls_unified.py

---

## ğŸš€ ä¸‹ä¸€æ­¥ï¼šéªŒè¯

### é‡å¯åç«¯æœåŠ¡å¹¶æµ‹è¯•

é©¬ä¸Šæ‰§è¡Œ...

