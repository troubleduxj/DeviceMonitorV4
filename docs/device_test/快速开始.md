# å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿæµ‹è¯•

æœ¬æŒ‡å—å¸®åŠ©ä½ å¿«é€Ÿå®Œæˆå‹åŠ›ä¼ æ„Ÿå™¨è®¾å¤‡ç±»å‹çš„åˆ›å»ºå’ŒAIæ£€æµ‹åŠŸèƒ½æµ‹è¯•ã€‚

---

## å‰ç½®æ¡ä»¶

ç¡®ä¿ä»¥ä¸‹æœåŠ¡å·²å¯åŠ¨ï¼š

- âœ… PostgreSQL (ç«¯å£: 5432)
- âœ… TDengine (ç«¯å£: 6041)
- âœ… Redis (ç«¯å£: 6379)
- âœ… åç«¯æœåŠ¡ (ç«¯å£: 8001)

---

## æ­¥éª¤1ï¼šæ‰§è¡ŒPostgreSQLè„šæœ¬ (2åˆ†é’Ÿ)

```bash
# è¿æ¥PostgreSQL
psql -h 127.0.0.1 -p 5432 -U postgres -d devicemonitor

# æ‰§è¡Œé…ç½®è„šæœ¬
\i docs/device_test/setup_pressure_sensor.sql

# éªŒè¯ç»“æœ
SELECT type_name FROM t_device_type WHERE type_code = 'PRESSURE_SENSOR_V1';
```

**é¢„æœŸè¾“å‡º**: `æ™ºèƒ½å‹åŠ›ä¼ æ„Ÿå™¨`

---

## æ­¥éª¤2ï¼šæ‰§è¡ŒTDengineè„šæœ¬ (1åˆ†é’Ÿ)

```bash
# è¿æ¥TDengine
taos -h 127.0.0.1 -P 6041 -u root -p taosdata

# æ‰§è¡Œè„šæœ¬
source docs/device_test/setup_tdengine.sql

# éªŒè¯æ•°æ®
SELECT COUNT(*) FROM tb_ps001;
```

**é¢„æœŸè¾“å‡º**: `11` (11æ¡æµ‹è¯•æ•°æ®)

---

## æ­¥éª¤3ï¼šæµ‹è¯•API (2åˆ†é’Ÿ)

### 3.1 ç™»å½•è·å–Token

```bash
curl -X POST http://localhost:8001/api/v2/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin123"}'
```

å¤åˆ¶è¿”å›çš„ `access_token`

### 3.2 æµ‹è¯•å¼‚å¸¸æ£€æµ‹

```bash
curl -X POST http://localhost:8001/api/v2/ai/anomalies/detect \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "data": [5.2, 5.3, 5.1, 5.4, 8.9, 9.2, 5.3, 5.2, 5.4],
    "device_code": "PS001",
    "method": "combined",
    "threshold": 3.0,
    "save_to_db": true
  }'
```

**é¢„æœŸç»“æœ**: æ£€æµ‹åˆ°2ä¸ªå¼‚å¸¸ç‚¹ï¼ˆç´¢å¼•4å’Œ5ï¼‰

---

## æ­¥éª¤4ï¼šæŸ¥çœ‹å‰ç«¯ (å¯é€‰)

1. å¯åŠ¨å‰ç«¯æœåŠ¡
```bash
cd web
pnpm dev
```

2. è®¿é—® http://localhost:3000

3. å¯¼èˆªåˆ° **è®¾å¤‡ç®¡ç†** â†’ æŸ¥æ‰¾ "PS001"

4. å¯¼èˆªåˆ° **AIç›‘æ§** â†’ **å¼‚å¸¸æ£€æµ‹** â†’ æŸ¥çœ‹ç»“æœ

### å‰ç«¯é¡µé¢è¯´æ˜

**è®¾å¤‡ç®¡ç†é¡µé¢**:
- è®¾å¤‡åˆ†ç±»ç®¡ç†: `/device/type` - æ–°å¢/ç¼–è¾‘è®¾å¤‡ç±»å‹
- è®¾å¤‡ä¿¡æ¯ç®¡ç†: `/device/baseinfo` - æ–°å¢/ç¼–è¾‘è®¾å¤‡
- æ”¯æŒæŒ‰è®¾å¤‡ç±»å‹ç­›é€‰

**AIç›‘æ§é¡µé¢**:
- å¼‚å¸¸æ£€æµ‹: `/ai-monitor/anomaly-detection`
- å¥åº·è¯„åˆ†: `/ai-monitor/health-scoring`
- è¶‹åŠ¿é¢„æµ‹: `/ai-monitor/trend-prediction`

**ğŸ’¡ è¯¦ç»†æ“ä½œæ­¥éª¤**:
- å¦‚ä½•é€šè¿‡UIæ–°å¢è®¾å¤‡åˆ†ç±»å’Œè®¾å¤‡ï¼Œè¯·æŸ¥çœ‹ [å‰ç«¯é¡µé¢æ“ä½œæŒ‡å—](./å‰ç«¯é¡µé¢æ“ä½œæŒ‡å—.md)
- å¦‚ä½•å¼€å‘è‡ªå®šä¹‰é¡µé¢ï¼Œè¯·æŸ¥çœ‹å®Œæ•´æŒ‡å—ä¸­çš„"ç¬¬å…«é˜¶æ®µï¼šå‰ç«¯é¡µé¢ç»´æŠ¤"ç« èŠ‚

---

## âœ… éªŒè¯æ¸…å•

- [ ] PostgreSQLä¸­åˆ›å»ºäº†è®¾å¤‡ç±»å‹å’Œå­—æ®µ
- [ ] TDengineä¸­åˆ›å»ºäº†è¶…çº§è¡¨å’Œå­è¡¨
- [ ] æˆåŠŸæ’å…¥äº†11æ¡æµ‹è¯•æ•°æ®
- [ ] APIå¼‚å¸¸æ£€æµ‹è¿”å›æ­£ç¡®ç»“æœ
- [ ] å‰ç«¯èƒ½å¤Ÿæ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯

---

## ğŸ”§ é‡åˆ°é—®é¢˜ï¼Ÿ

### é—®é¢˜1ï¼šPostgreSQLè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status postgresql  # Linux
# æˆ–
pg_ctl status  # Windows
```

### é—®é¢˜2ï¼šTDengineè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status taosd  # Linux
# æˆ–æŸ¥çœ‹è¿›ç¨‹
ps aux | grep taosd
```

### é—®é¢˜3ï¼šAPIè¿”å›401
- æ£€æŸ¥tokenæ˜¯å¦æ­£ç¡®
- ç¡®è®¤tokenæœªè¿‡æœŸ
- é‡æ–°ç™»å½•è·å–æ–°token

---

## ğŸ“š ä¸‹ä¸€æ­¥

å®Œæˆå¿«é€Ÿæµ‹è¯•åï¼ŒæŸ¥çœ‹å®Œæ•´æ–‡æ¡£äº†è§£æ›´å¤šåŠŸèƒ½ï¼š

- [æ–°å¢è®¾å¤‡ç±»å‹ä¸AIæ£€æµ‹å®ç°æŒ‡å—.md](./æ–°å¢è®¾å¤‡ç±»å‹ä¸AIæ£€æµ‹å®ç°æŒ‡å—.md) - å®Œæ•´å®æ–½æŒ‡å—
- [setup_pressure_sensor.sql](./setup_pressure_sensor.sql) - PostgreSQLé…ç½®è„šæœ¬
- [setup_tdengine.sql](./setup_tdengine.sql) - TDengineé…ç½®è„šæœ¬

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ‰
